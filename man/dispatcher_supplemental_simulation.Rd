% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/supplemental_protection_simulator.R
\name{dispatcher_supplemental_simulation}
\alias{dispatcher_supplemental_simulation}
\title{Dispatcher: simulate supplemental outcomes for one draw}
\usage{
dispatcher_supplemental_simulation(
  sim,
  year,
  agents_dir = "data/cleaned_agents_data",
  cleaned_rma_sco_and_eco_adm_file_path = "data/cleaned_rma_sco_and_eco_adm.rds",
  output_directory = NULL
)
}
\arguments{
\item{sim}{Integer. Draw number used in data building and the filename.}

\item{year}{Integer. Crop year.}

\item{agents_dir}{Character. Directory for cleaned agents data.}

\item{cleaned_rma_sco_and_eco_adm_file_path}{Character. Path to RDS of SCO/ECO ADM
with join keys and \code{base_rate}. Default:
\code{"data/cleaned_rma_sco_and_eco_adm.rds"}.}

\item{output_directory}{Character or \code{NULL}. Where to write results;
see Details for default behavior.}
}
\value{
Invisibly writes \code{simXXX.rds} to \code{output_directory}.
}
\description{
Orchestrate the full supplemental simulation workflow for a given crop year
and draw: build the agent panel, compute base-policy results, generate
supplemental factors, assemble \emph{Current}, \emph{Full}, and
\emph{Incremental} scenarios, and write the combined results to disk.
}
\details{
The pipeline:
\enumerate{
\item \code{\link{build_agent_simulation_data}} to construct the panel.
\item \code{\link{compute_base_policy_outcomes}} for base outcomes.
\item \code{\link{study_scenarios}} to enumerate offerings/mixes.
\item Load SCO/ECO ADM; filter to \code{commodity_year == year}; average
\code{base_rate} by key; drop invalid/zero rates.
\item Loop offerings through \code{\link{compute_supplemental_factors}}.
\item Build scenarios:
\itemize{
\item \emph{Current}: \code{\link{compute_supplemental_current}}.
\item \emph{Full}: \code{\link{compute_supplemental_full}}.
\item \emph{Incremental}: \code{\link{compute_supplemental_incremental}}.
}
\item Aggregate base-only results, \code{rbind} all scenarios, and save as
\code{simXXX.rds} in \code{output_directory}.
}

If \code{output_directory} is \code{NULL}, it defaults to
\code{file.path(study_env$wd$dir_sim, year)} (ensure \code{study_env$wd$dir_sim}
exists in the calling environment).
}
